# 8일차

## 컨테이너란?
  컨테이너라는 기술의 정의는 프로그램을 실행할 때 필요한 모든 파일을 포함한 전체 실행 환경에서 앱을 패키징 또는 격리 시킬 수 있는 기술입니다.  
    
  예시 ) 고기(프로그램)를 담는 냉동시설(환경)이 되어있는 저장고가 필요할때 고기가 썩지 않게 냉동시설(환경)이 되어있는 컨테이너 자체를 제공하는 것을 **컨테이너**라고 합니다.

  실제 컨테이너를 활용환 기술로는 리눅스 컨테이너, 도커 컨테이너가 있습니다.  

  두 컨테이너의 차이점은 무엇일까요?  
  
### 차이점
차이로는 두 컨테이너가 실제로 동작되는 부분에서 나는데요.   
아래사진을 보게 되시면

![](https://www.redhat.com/rhdc/managed-files/traditional-linux-containers-vs-docker_0.png)

왼쪽이 리눅스 컨테이너의 기반인 LXC 오른쪽이 Docker입니다.  
자 사진을 보게되면 LXC의 같은 경우 OS가 존재하고 위에 하나의 앱당 여러개의 프로세스들을 모든 애플리케이션을 하나로 띄워서 실행을 합니다.    

그에 반해 Docker 같은경우 OS와 Docker Engine이라는 프로그램이 껴있고 그 위에 APP이 각 프로세스 들과 LIB들이 존재하는 형태로 실행이 됩니다.

간단하게 설명하면 Docker는 LXC보다 세세하게 애플리케이션을 개별 프로세스로 나누도록 권장을 합니다.
  
## 가상화
저희는 컨테이너와 함께 땔 수 없는 가상화도 존재하는데요 가상화에 대해서 알아보도록 하겠습니다.  
가상화는 단일 기기에서 여러개의 OS를 동시에 실행할 수 있도록 해줍니다.  

여기서 가상화의 특징이 나오는데요 가상화는
![](https://www.redhat.com/rhdc/managed-files/virtualization-vs-containers.png)

각 앱과 OS가 존재하면 HYPERVISOR이란 기기를 에뮬레이션화 한 다음 이를 이용하여 여러 개의 OS들을 병렬 실행합니다. 여기서 알 수 있듯이 가상화는 컨테이너 만큼 경량화 할 수 없다는 단점이 있습니다.

또한 컨테이너의 특징은 공통된 OS에서 진행된다는것인데요  
여러개의 컨테이너가 공통된 OS를 공유하고 있기에 빠르게 실행하거나 관리하는데 편하다는 특징이 있습니다.

## 컨테이너의 장점
컨테이너의 장점은 크게 세가지 정도라고 생각합니다.  
1. 프로그램을 실행하기 위한 환경을 내가 세팅하지 않고 컨테이너가 제공하는것을 사용하면 됨.   
이 장점으로 인하여 실제 복잡한 작업이 줄어들었다는 것입니다.  

2. 프로그램을 굉장히 가볍게 경량화 시킬 수 있음.   
실제 저희에게 주어진 리소스나 자원이 제한 되어 있을때 가상화 처럼 많은 자원을 쓸 수 없는 환경에서 경량화는 큰 장점이라고 합니다.   

3. 실행하거나 관리를 편하게 할 수 있다.   
같은 OS 체제에서 동작되기 때문에 실행하는 부분과 관리에서도 프로그램과 미들웨어만 실행 시키면 되기에 속도와 관리에도 용의합니다.

## 컨테이너의 단점
컨테이너의 단점은 2가지 정도라고 생각합니다.   
1. 보안  
보안이라고 말하면 익숙치 않을수도 있지만 쉽게 말하자면 컨테이너는 다중 레이어로 구성화 되어있어  보안 설정을 할 때 멀티 레벨 보안이 필요합니다.   

2. 데이터 저장.  
영구적인 컨테이너의 경우 어디론가 파일이 옮겨져야 하기에 컨테이너 설계가 데이터 유출의 배후가 될 수도 있고 그렇다고 다른곳에 저장하지 않을경우 컨테이너가 종료될 시 컨테이너 내부의 데이터가 전부 삭제 될 수도 있다라는 단점이 있습니다.

## 그래서 왜 씀?
컨테이너를 사용하는 가장 중요한 이유는 위에서도 자주 나왔던 경량화 + 사용하기 간편함이라는 부분이 크게 작용 할 거 같습니다.   
실제로 개발자들이 사용하는 모습을 보게 되면 가상화 때는 하기 힘들던 작은 단위의 업무를 수행하는것이 편해진다라는 부분 또한 쓰는데 큰 장점을 가져옵니다. 

# 도커(Docker)
## 도커란
도커는 앞에서 배운 개념인 리눅스 컨테이너를 만들고 사용할 수 있게 도와주는 툴입니다.

## 도커의 장단점
### 도커의 장점

1. 모듈성.  
도커에서 컨테이너화에 대해서 생각하는 부분은 전체의 프로그램을 분해하면서 업데이트나 오류 수정을 거치는 것이 아닌 프로그램의 일부만 분해하는 기능에 중점을 두고 있기에 SOA를 와 거의 같은 방식으로 멀티플 애플리케이션 간에 프로세스를 공유 가능하다는 장점이 있습니다.

2. 계층 및 이미지 버전 제어.   
각 Docker 이미지는 하나의 계층으로 구성되는데 이렇게 만들어진 계층들은 하나의 단일 이미지로 만들어집니다.(계층이 새로 생기게 되는 경우는 사용자가 실행, 복사 혹은 변경사항이 생길시 생겨나게 됩니다.)    

### 도커의 단점

1. 운영체제  
리눅스 운영체제에서 실행되는 프로그램만 지원한다.

2. 위험성  
물리적 서버 한대에 여러 개의 컨테이너를 띄우고 모두 관리하기 때문에  
호스트 서버에 문제가 생길 시 모든 컨테이너가 치명적 손상을 입게된다.

## 도커의 용도  
도커의 용도로는 팀원들과 다 함께 같은 개발 환경에서 진행할 때(동일한 환경이 여러개).  
새로운 버전으로 업그레이드를 테스트 해야 할 때(격리된 환경에서 테스트 가능)정도가 있다.

## 도커의 구성 요소
도커의 구성 요소 중 중요한 이미지, 컨테이너에 대해서 알아보도록 하곘습니다.

### 이미지
도커에서 이미지는 서비스를 운영할 때 필요한 모든 정보를 담고 있습니다.
에시 ) 소스코드 및 라이브러리,서버 프로그램  
특정 프로세스(컨테이너)를 실행하기 위한 모든 파일과 설정값을 지닌 더 이상 다른 파일을 다운로드하거나 그럴 필요 없는 상태의 파일을 말합니다.  

### 컨테이너  
위에서 다운로드 받은 이미지를 실행시킨 상태입니다.  
응용프로그램 자체를 패키징이나 캡슐화를 통하여 **격리된** 공간에서 프로세스를 실행한다는 기술입니다.

## 둘의 동작 방법
![](https://blog.kakaocdn.net/dn/ZR1qF/btq6WPzgJKN/FA3nqYDDsdKQueMKsnGaSk/img.png)  

한번 보도록 하자.  
처음 우리가 의도했던 임의에 Docker Image를 생성한다 그럼 생성된 Docker Image를 run 할 경우  
Docker image를 실행 할 시 이미지가 담고있던 프로그램, 담고 있던 라이브러리 등을 실제로 docker container로 실제 프로세스화 시킨다.  
이 상태에서는 만약 MYSQL 도커이미지를 실행시켰으면 MYSQL이 실행된것이다.  
(하나의 이미지로 여러개의 컨테이너를 실행 시킬 수 있다.)

컨테이너는 종료한다고 메모리에서 삭제가되는것이 아닌 명시적으로 삭제해야한다 이는 컨테이너가 종료가 되어 있다 하더라도 컨테이너 & 읽기,쓰기 Layer 또한 존재하여 다시 살릴 수 있다.

다만 컨테이너는 삭제될 경우 가지고 있는 모든 데이터가 삭제되기 때문에 조심해야한다.

## 이미지와 레이어(Layer)
레이어가 존재하는 이유는 이미지에 다른 파일을 추가해야 할 때 다시 다운 받는 방법이 아닌  
해당 파일만 추가하는 방법이다.  
(이미지는 여러개의 읽기전용으로 구성되어 있고 파일이 추가될시 새 Layer가 추가되면 도커에서 여러개의 Layer를 묶어 하나의 파일 시스템으로 이용가능하도록 변경한다.)

# 내가 생각하는 컨테이너
이번 공부를 통하여 내가 배운 컨테이너의 개념으로는 협업이나 여러 컴퓨터의 동일한 환경을 만들어야 할 때, 하나의 애플리케이션을 간편하게 실행하고 관리하고 싶을때 이용하는 기능이라고 느꼈다.  
실제 가상화가 주를 이루던 시절 어느정도 적당한 서버가 존재하지 않았던 상황에 겪어 힘든 상황에서  
이를 개선하기 위해 하나의 OS로 통일 되었긴 하지만 경량화가 된 컨테이너가 굉장히 매력적으로 느껴졌다 실제로도 도커를 이용하여 격리 환경에서 테스트를 해볼 수 있다는게 좋았다 나도 굉장히 도커를 이용하여 DB들을 실행하고 있는데 명령어 하나면 두개의 MySQL, Redis 컨테이너가 올라가는 것을 전엔 그저 이해만 했다면 이제는 이걸 이용하여 내 백엔드 프로젝트 자체를 배포 해보고 싶다라는 생각이 들게 되었습니다(실제 데이터베이스, 환경설정이 되어 있는 내 프로젝트).
